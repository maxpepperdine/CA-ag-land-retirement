---
title: "3_hab_suit_diff"
format: html
---

```{r}
install.packages("remotes")
remotes::install_github("wallaceEcoMod/wallace")
```


```{r}
library(wallace)
run_wallace()
```



```{r}
# clear the environment
rm(list = ls())
```

## Overview/Purpose

This script compares habitat suitability estimates for various species, finding the difference in values of habitat suitability between different models. This will allow an easy visual comparison of differences in where one model is predicting high/low suitability versus another.

## Setup

#### Load Packages

```{r}
library(terra)
library(tidyverse)
library(here)
library(sf)
```

#### Load data

###### Habitat suitability

```{r}
##### Blunt-nosed leopard lizard habitat suitability rasters #####

# Stewart et al. (2019) model
bnll_stewart <- rast(here("data/raw/habitat_suitability/stewart_2019/G_sila_cont_suit.tif"))

# Fallow SJV model
bnll_fallowSJV <- rast(here("data/intermediate/misc/habitat_suitability/sdm_files/Gambelia_sila_unclipped.tif"))


##### Giant kangaroo rat habitat suitability rasters #####
```

###### Misc

```{r}
# load SJV boundary for masking
sjv_boundary <- read_sf(here("data/raw/sjv_counties/sjv_counties.shp"))
```

## Process Data

#### Make sure all are in `EPSG:3310`

```{r}
# transform SJV boundary to EPSG:3310
sjv_boundary <- st_transform(sjv_boundary, crs = 3310)
crs(sjv_boundary)
# convert to terra vector
sjv_vect <- vect(sjv_boundary)

##### reproject habitat suitability rasters to EPSG:3310 #####

# blunt-nosed leopard lizard
bnll_stewart_3310 <- project(bnll_stewart, crs(sjv_boundary))
bnll_fallowSJV_3310 <- project(bnll_fallowSJV, crs(sjv_boundary))
```

#### Crop and mask rasters to SJV boundary

```{r}
# blunt-nosed leopard lizard
bnll_stewart_crop <- bnll_stewart_3310 %>%
  crop(sjv_vect) %>%
  mask(sjv_vect)
bnll_fallowSJV_crop <- bnll_fallowSJV_3310 %>%
  crop(sjv_vect) %>%
  mask(sjv_vect)
plot(bnll_stewart_crop)
plot(bnll_fallowSJV_crop)

# giant kangaroo rat
```




